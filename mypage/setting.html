<!DOCTYPE html>
<html lang="ja">
    <head>
        <meta charset="UTF-8" />
        <meta name="csrf-token" content="{{ csrf_token() }}" />
        <title>Web発注システム</title>
        <link rel="icon" type="image/png" href="../images/sitelogo.png" />
        <link rel="stylesheet" href="../css/bootstrap.min.css" />
        <link rel="stylesheet" href="../css/style.css" />
        <script src="../js/jquery-3.7.1.min.js"></script>
    </head>

<body>
    <!-- header -->

    <div class="container-logo">
        <nav class="nav-logo">
            <img src="../images/tennic-logo.png" alt="Logo"/>
        </nav>

        <nav class="navbar-50">
            <span class="text-white">スポーツハウス アローザ </span>
        </nav>
    </div>

    <div class="main-container setting-width">
        <!-- left menu -->
        <aside>
            <div class="container mt-2 position-relative ">
                <button class="btn btn-primary mb-4 d-flex justify-content-between align-items-center rounded-0" onclick="location.href='./order_detail.html'">
                    <span class="mx-auto">直接入力</span>
                    <img src="../images/chevron-right.svg">
                </button><hr>

                <div class="mb-4 text-center">
                    <label class="form-label">品番</label>
                    <input type="text" class="form-control rounded-0" />
                    <input type="text" class="form-control rounded-0" />
                    <input type="text" class="form-control rounded-0" />
                    <input type="text" class="form-control rounded-0" />
                    <input type="text" class="form-control rounded-0" />
                </div>

                <div class="mb-3 text-center">
                    <label class="form-label text-decoration-underline">ブランド選択</label>
                    <div class="d-inline-block position-relative mb-2">                        
                        <div class="form-control rounded-0 f2f2-bg tooltip-input" onmouseover="showTooltip(this)" onmouseout="hideTooltip(this)">
                        ヨネックス
                        </div> 
                    </div>
                </div>
                <div class="mb-3 text-center">
                    <label class="form-label text-decoration-underline">カテゴリ選択</label>
                    <div class="d-inline-block position-relative mb-2">
                        <div class="form-control rounded-0 f2f2-bg tooltip-input" onmouseover="showTooltip(this)" onmouseout="hideTooltip(this)">
                          アクセサリ、シューズ
                        </div>                   
                    </div>
                </div>

                <button class="btn btn-primary mb-4 d-flex justify-content-between align-items-center rounded-0">
                    <span class="mx-auto">検索</span>
                    <img src="../images/chevron-right.svg">
                </button><hr>
            </div>

            <label class="form-label mt-2">一括注文</label>
            <button class="btn btn-primary mb-2 d-flex justify-content-between align-items-center rounded-0">
                <span class="mx-auto">CSV選択</span>
                <img src="../images/chevron-right.svg">
            </button>

			<label class="form-label text-decoration-underline mb-5">一括注文とは？</label>

            <nav class="nav flex-column nav-list">
                <a class="nav-link text-white position-relative" href="./home.html">
                    <img src="../images/house-door-fill.svg" class="me-3"> ホーム
                </a>
                <a class="nav-link text-white position-relative" href="./order_history.html"> 
                    <img src="../images/file-earmark-text-fill.svg" class="me-3">注文履歴</a>
                <a class="nav-link text-white position-relative" href="./setting.html">
                     <img src="../images/gear_fill_menu.svg" class="me-3">設定</a>
                <a class="nav-link text-white position-relative nav-link-after" href="#"> 
                    <img src="../images/box-arrow-left.svg" class="me-2">ログアウト</a>
            </nav>
            </nav>
        </aside>

        <main class="flex-grow-1">
            <div class="settings">
                <div class="container-fluid">
                    <div class="main-header">
                        <h3>
                            <img src="../images/gear_fill.svg" alt="Settings Icon" class="header-icon">
                            <span class="ms-2">設定</span>
                        </h3>
                    </div>
                    
                    <div class="alert sucess-alert alert-dismissible fade d-flex justify-content-between align-items-center" id="sucess-alert" role="alert">
                        <strong>設定を保存しました</strong>
                        <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    
                    
                    <div class="container-main-content">
                        
                        <div class="main-content-left">
                            <div class="content-left-element">
                                 <label for="shipping-default" class="shipping-default">配送先デフォルト設定</label>
                            <select name="shipping_default" id="shipping-default">
                                <option value="option1">スポーツハウス アローザ 1</option>
                                <option value="option2">スポーツハウス アローザ 2</option>
                                <option value="option3">スポーツハウス アローザ 3</option>
                                <option value="option4">スポーツハウス アローザ 4</option>
                            </select>
        
                            <!-- Registered Email -->
                            <form id="email-form">
                                <label for="email" class="email"">登録メールアドレス</label>
                                <p id="warning-error" class="warning-message">※メールアドレスは注文完了時に使用します</p>
                                <input type="email" name="email" id="email" required>
                                <label for="confirm-email" class="confirm-email-label">確認用</label>
                                <input type="email" name="confirm_email" id="confirm-email" required>
                                <p id="email-error" class="error-message">確認用メールアドレスが一致していません                        </p>
        
                                
                                <button type="submit" class="submit-button">この内容で設定する</button>
                             </form>
                            </div>
                           
                        </div>

                        <div class="main-content-right">
                            <!-- Postal Code -->
                            <div class="align-items-center mt-3">
                                <label for="zip1">郵便番号</label>
                                <div id="zip1" class="zip1"></div>
                                <span>-</span>
                                <div id="zip2" class="zip2"></div>
                            </div>
        
                            <!-- Address -->
                            <div class="address-container">
                              <div class="address-row">
                                  <label for="address1" class="label-text">住所</label>                                  
                                  <div id="address1" class="address1 tooltip-input" onmouseover="showTooltip(this)" onmouseout="hideTooltip(this)"></div>
                                
                              </div>
                              <div class="address-row">
                                <label for="address2" class="label-text"></label>         
                                  <div id="address2" class="address2 tooltip-input" onmouseover="showTooltip(this)" onmouseout="hideTooltip(this)"></div>
                              </div>
                          </div>
                          
                            <!-- Phone Number -->
                            <div class="d-flex align-items-center gap-1">
                                <label for="Tel1">電話番号</label>
                                <div class="phone-number-container">
                                    <div id="Tel1" class="tel-input"></div>
                                    <span>-</span>
                                    <div id="Tel2" class="tel-input"></div>
                                    <span>-</span>
                                    <div id="Tel3" class="tel-input"></div>
                                </div>
                            </div>
                            <p>※情報に誤りがある場合はお手数ですがテニックまでご連絡ください。</p>
    
                           </div>
                          
                        </div>

                    </div>
                </div>
            </div>
            
        </main>
    </div>
    <script>
        function showTooltip(element) {
            let tooltip = document.querySelector('.tooltip-box');
            if (!tooltip) {
                tooltip = document.createElement('div');
                tooltip.classList.add('tooltip-box');
                document.body.appendChild(tooltip);
            }

            tooltip.textContent = element.textContent.trim();
            if (element.scrollWidth - element.clientWidth > 1) {
                const rect = element.getBoundingClientRect();
                tooltip.style.display = 'block';
                tooltip.style.top = `${rect.top + window.scrollY + element.offsetHeight + 15}px`;
                tooltip.style.left = `${rect.left + window.scrollX}px`;

                let tooltipRect = tooltip.getBoundingClientRect();
                const windowWidth = window.innerWidth;

                if (tooltipRect.right > windowWidth) {
                    let currentLeft = parseInt(tooltip.style.left) || 0;
                    let newLeft = currentLeft - (tooltipRect.right - windowWidth) - 50;
                    tooltip.style.left = `${newLeft}px`;
                    
                    tooltipRect = tooltip.getBoundingClientRect();
                
                    let arrowLeft = rect.left - tooltipRect.left + element.offsetWidth / 4 -15; 
                    tooltip.style.setProperty('--tooltip-arrow-left', `${arrowLeft}px`);
                } else {           
                    let arrowLeft = element.offsetWidth / 4 - 15;
                    tooltip.style.setProperty('--tooltip-arrow-left', `${arrowLeft}px`);
                }
            } else {
                tooltip.style.display = 'none';
            }
        }

        function hideTooltip() {
            const tooltip = document.querySelector('.tooltip-box');
            if (tooltip) {
                tooltip.style.display = 'none';
            }
        }

       $(document).ready(function () {           
            let currentPage = window.location.pathname.split("/").pop();  // Get current page URL            
            $(".nav-list .nav-link").removeClass("active-nav"); // Remove active class from all links first           
            $('.nav-list .nav-link[href="./' + currentPage + '"]').addClass("active-nav");  // Find the matching link and add the active class
    
            var submitButton = $('.submit-button');
    var errorText = $("#email-error");
    var alertBox = $('.sucess-alert');

    alertBox.removeClass("show");

    if (localStorage.getItem("emailSaved") === "true") {
        alertBox.addClass("show");
    }

    // Handle form submission
    $("#email-form").submit(function (event) {
        event.preventDefault();
        var email = $('#email').val();
        var confirmEmail = $('#confirm-email').val();

        if (email === confirmEmail) {
            alertBox.addClass("show"); // Show alert smoothly
            localStorage.setItem("emailSaved", "true");
            errorText.hide();
        } else {
            errorText.show();
        }
    });

    // Hide success alert when user edits email fields
    $('#email, #confirm-email').on('input', function () {
        localStorage.removeItem("emailSaved");
        alertBox.removeClass("show"); // Hide alert smoothly
    });

    // Hide success alert when clicking close button
    $(".close").click(function () {
        alertBox.removeClass("show");
    });

    // Clear localStorage on page refresh
    $(window).on('beforeunload', function () {
        localStorage.removeItem("emailSaved");
    });
    
            $('#email, #confirm-email').on('paste contextmenu', function (event) {
                event.preventDefault();
            });
    
            $('#email, #confirm-email').attr('autocomplete', 'off');
    
            // Shipping default selection handling
            $('#shipping-default').on('change', function () {
                const selectedOption = $(this).val();
                updateFields(selectedOption);
            });
    
            const defaultOption = $('#shipping-default').val();
            updateFields(defaultOption);
    
            function updateFields(option) {
                const data = {
                    option1: {
                        zip1: '566',
                        zip2: '000000',
                        tel1: '06',
                        tel2: '6666',
                        tel3: '6666',
                        address1: '東京都新宿区',
                        address2: 'スポーツハウス アローザ 1',
                    },
                    option2: {
                        zip1: '567',
                        zip2: '111111',
                        tel1: '03',
                        tel2: '7777',
                        tel3: '7777',
                        address1: '東京都新宿区',
                        address2: 'スポーツハウス アローザ 2',
                    },
                    option3: {
                        zip1: '568',
                        zip2: '222222',
                        tel1: '04',
                        tel2: '8888',
                        tel3: '8888',
                        address1: '横浜市中区',
                        address2: 'スポーツハウス アローザ 3',
                    },
                    option4: {
                        zip1: '569',
                        zip2: '333333',
                        tel1: '05',
                        tel2: '9999',
                        tel3: '9999',
                        address1: '大阪市北区',
                        address2: 'スポーツハウス アローザ 4',
                    }
                };
    
                const userData = data[option];
    
                $('#zip1').text(userData.zip1);
                $('#zip2').text(userData.zip2);
                $('#Tel1').text(userData.tel1);
                $('#Tel2').text(userData.tel2);
                $('#Tel3').text(userData.tel3);
                $('#address1').text(userData.address1);
                $('#address2').text(userData.address2);
            }
        });
    </script>
    
</body>

</html>
